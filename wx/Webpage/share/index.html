
<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<meta name="viewport"
          content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
	<title>分享</title>
</head>
<body>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script src="zepto.min.js"></script>
    <input type="button" value="上传图片" onclick="Img()">
<script>

		$.ajax({
                url: "http://60.205.138.173:8080/others/share/signature",
                type: 'post',
                data: {
                    url: location.href.split('#')[0]
                },
                success: function (data) { // 在服务器端完成签名，签名用的noncestr和timestamp必须与wx.config中的nonceStr和timestamp相同，
                    var values = data.value;
                    var timestamp = values.timestamp;
                    var nonceStr = values.noncestr;
                    var signature = values.signature;
                    wx.config({
                        debug: false,
                        appId: 'wx8df662bef1a3a461', // 必填，公众号的唯一标识
                        timestamp: timestamp, // 必填，生成签名的时间戳
                        nonceStr: nonceStr, // 必填，生成签名的随机串
                        signature: signature, // 必填，签名，见附录1
                        // 必填，需要使用的JS接口列表，所有JS接口列表见附录
                        jsApiList: [ // 调用的wx的API的接口
                            "onMenuShareAppMessage",
                            "onMenuShareTimeline",
                            "onMenuShareQQ",
                            "onMenuShareWeibo",
                            "onMenuShareQZone",
                            "chooseImage"
                        ]
                    });

                    wx.ready(function(){
                        //分享给朋友 配置分享的
                        wx.onMenuShareAppMessage({
                            title:document.title,// 分享的标题就是文本的标题
                            desc:"分享描述",
                            link:"http://www.caizhanbao.cn/h5weixin/", // 域名必须和公众号后台配置的域名一致
                            imgUrl:"http://caizhanbao.cn/h5weixin/img/share.png",// 分享图标 
                            type: 'link', // 分享类型,music、video或link，不填默认为link
                             success: function () { 
                                    console.log("分享成功")
                             },
                             cancel:function(){
                                console.log("取消分享")
                             }

                        });


                        
                        wx.onMenuShareQQ({
                            title:"caonima",
                            desc:"hello草拟吗",
                            link:"http:www.baidu.com",
                            imgUrl:"",
                            type:"link",
                            success:function  () {
                                console.log("qq好友")
                            },
                            cancel:function () {
                                console.log("qq失败")
                            }
                        })
                    })
                   
                }
            });

    function Img () {
        wx.chooseImage({
            count:1,//默认9
            sizeType:['original','compressed'],// 可以指定是原图还是压缩图
            success:function  (res) {
                // body... 
                console.log(res)
            }
        }) 
    }
	
</script>
	<div class="main">hello</div>
</body>
</html>